<!DOCTYPE html>
<html>
<head>
  <title>Clubs</title>
</head>
<body>

<h2>Clubs</h2>

<!-- INSERT FORM -->
<h3>Add New Club</h3>
<form id="addClubForm">
  Name: <input name="clubName" required><br>
  Description: <input name="description"><br>
  Budget: <input name="budget" type="number" step="0.01"><br>
  <button type="submit">Add Club</button>
</form>

<br><hr>

<!-- TABLE -->
<table border="1" id="clubsTable">
  <tr>
    <th>ID</th><th>Name</th><th>Description</th><th>Budget</th><th>Edit</th><th>Delete</th>
  </tr>
</table>

<script>
// LOAD TABLE
function loadClubs() {
  fetch('/api/clubs')
    .then(r => r.json())
    .then(rows => {
      const table = document.getElementById("clubsTable");
      table.innerHTML = `
        <tr>
          <th>ID</th><th>Name</th><th>Description</th><th>Budget</th><th>Edit</th><th>Delete</th>
        </tr>`;

      rows.forEach(c => {
        table.innerHTML += `
          <tr id="row-${c.clubID}">
            <td>${c.clubID}</td>
            <td>${c.clubName}</td>
            <td>${c.description}</td>
            <td>${c.budget}</td>
            <td><button onclick="editClub(${c.clubID}, '${c.clubName}', '${c.description}', '${c.budget}')">Edit</button></td>
            <td><button onclick="deleteClub(${c.clubID})">Delete</button></td>
          </tr>
          <tr id="edit-${c.clubID}" style="display:none;">
            <td colspan="6">
              <h4>Edit Club</h4>
              Name: <input id="editName-${c.clubID}" value="${c.clubName}"><br>
              Description: <input id="editDesc-${c.clubID}" value="${c.description}"><br>
              Budget: <input id="editBudget-${c.clubID}" type="number" step="0.01" value="${c.budget}"><br>
              <button onclick="saveClub(${c.clubID})">Save</button>
              <button onclick="cancelEdit(${c.clubID})">Cancel</button>
            </td>
          </tr>`;
      });
    });
}

// SHOW EDIT FORM
function editClub(id) {
  document.getElementById(`edit-${id}`).style.display = '';
}

// CANCEL EDIT
function cancelEdit(id) {
  document.getElementById(`edit-${id}`).style.display = 'none';
}

// SAVE CHANGES
function saveClub(id) {
  const data = {
    clubName: document.getElementById(`editName-${id}`).value,
    description: document.getElementById(`editDesc-${id}`).value,
    budget: document.getElementById(`editBudget-${id}`).value
  };

  fetch(`/api/clubs/${id}`, {
    method: "PUT",
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify(data)
  }).then(() => loadClubs());
}

// DELETE
function deleteClub(id) {
  fetch(`/api/clubs/${id}`, { method: "DELETE" })
    .then(() => loadClubs());
}

// INSERT
document.getElementById("addClubForm").addEventListener("submit", function(e) {
  e.preventDefault();
  const data = {
    clubName: this.clubName.value,
    description: this.description.value,
    budget: this.budget.value
  };

  fetch("/api/clubs", {
    method: "POST",
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify(data)
  }).then(() => {
    this.reset();
    loadClubs();
  });
});

// INITIAL LOAD
loadClubs();
</script>

</body>
</html>

